---
epic: 1
story: 7
title: "Global Cart Button"
status: "Draft"
---

### Story Statement

As a user, I want to see a persistent cart icon that shows how many items I have added, so I can easily access my order at any time.

### Acceptance Criteria

1.  A `GlobalCart` component is created.
2.  The component is displayed in the top-left of the screen layout.
3.  It contains a cart icon.
4.  A badge is displayed on the icon showing the current number of items in the cart. The badge should be hidden if the cart is empty.
5.  Clicking this button initiates the checkout process by opening the "Cart Summary" bottom sheet drawer.

### Dev Notes

#### Technical Specifications

*   **Component:** `GlobalCart` will be a shared component, likely placed in the root layout of the application to ensure it is persistent across views. [Source: `docs/prd.md#Story-1.7`]
*   **State Management:** The component must subscribe to a global `useCartStore` (Zustand) to get the real-time count of items in the cart. [Source: `docs/architecture.md#Section-6`]
*   **UI:** The component will consist of a cart icon (from `lucide-react`) and a small badge element. The badge's visibility will be conditional on the cart item count.

#### File Locations

*   **Component:** `apps/client/src/components/shared/global-cart.tsx` (inferred)
*   **State Store:** `apps/client/src/store/use-cart.store.ts` [Source: `docs/ui-architecture.md#Section-5`]

### Tasks / Subtasks

1.  **(AC: 1)** Create the `global-cart.tsx` component file.
2.  **State:** Ensure the `use-cart.store.ts` Zustand store is created and provides a way to get the total number of unique items.
3.  **(AC: 3)** Inside the component, subscribe to the cart store to get the item count.
4.  **(AC: 3, 4)** Implement the JSX to display a cart icon. Add a small badge component that conditionally renders on top of the icon if the item count is greater than zero, displaying the count.
5.  **(AC: 2)** Add the `GlobalCart` component to the root layout file (`apps/client/src/app/layout.tsx`) to ensure it is always visible.
6.  **(AC: 5)** Add a placeholder `onClick` handler to the button. The logic to open the Cart Summary drawer will be implemented in a later story.
7.  **Test (Integration):** Write tests to verify:
    *   The badge is hidden when the cart store is empty.
    *   The badge appears with the correct count when items are added to the store.

---

### Tasks / Subtasks (Idempotent)

- [x] **(AC: 1)** Create the `global-cart.tsx` component file.
- [x] **State:** Create the `use-cart.store.ts` Zustand store.
- [x] **(AC: 3)** Subscribe the component to the cart store.
- [x] **(AC: 3, 4)** Implement the JSX to display the cart icon and conditional badge.
- [x] **(AC: 2)** Add the `GlobalCart` component to the root layout file.
- [x] **(AC: 5)** Add a placeholder `onClick` handler.
- [x] **Test (Integration):** Write and pass all tests to verify the component's rendering and state integration.
- [x] **Finalize:** Mark the story as complete.

### Dev Agent Record

**Completion Notes:**

*   **Implementation:** Created the `GlobalCart` component in `apps/client/src/components/shared/global-cart.tsx`.
*   **State Management:** Created the `useCartStore` in `apps/client/src/store/use-cart.store.ts` to manage the application's shopping cart state. The `GlobalCart` component subscribes to this store to get a real-time count of the total number of items in the cart.
*   **UI/UX:** The component displays a persistent cart icon in the top-left corner of the screen. A numerical badge is conditionally rendered on the icon, showing the number of items in the cart. The badge is hidden when the cart is empty.
*   **Integration:** The `GlobalCart` component has been added to the root `layout.tsx`, ensuring it is visible across all pages and views of the application.
*   **Testing:** Developed a test suite in `src/__tests__/components/shared/global-cart.test.tsx` that verifies the component's behavior in response to changes in the cart store. All tests are passing.

**File List:**

*   `apps/client/src/store/use-cart.store.ts` (created)
*   `apps/client/src/components/shared/global-cart.tsx` (created)
*   `apps/client/src/app/layout.tsx` (modified)
*   `docs/qa/assessments/1.7-test-global-cart.md` (created)
*   `apps/client/src/__tests__/components/shared/global-cart.test.tsx` (created)
*   `docs/stories/1.7.story.md` (modified)

**Change Log:**

*   feat(1.7): create global cart button and store
*   test(1.7): add tests for global cart component
