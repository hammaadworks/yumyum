---
epic: 1
story: 6
title: "Dish Grid View (v2 - Corrected)"
status: "Draft"
---

### Story Statement

As a user, I want to see all the menu items in a clear, visual grid, and this grid should update when I apply filters or sorting.

### Acceptance Criteria

1.  A `DishGrid` component is created. It receives the full list of dishes and the active filter/sort states from the `ControlsBar`.
2.  The component filters dishes based on the "Veg Only" toggle state.
3.  The component sorts the filtered dishes based on the "Sort by Price" control state.
4.  The dishes are rendered in a responsive grid that displays as 3 columns on larger screens and adjusts appropriately for smaller screens.
5.  Each item is a `DishCard` that displays the dish's image and a pulsing dot indicator if it has a `tag`.
6.  Clicking a `DishCard` updates the application state to launch the Reel View, starting with the selected dish.

### Dev Notes

#### Technical Specifications

*   **Components:** This feature requires two components:
    *   `DishCard`: Displays a single dish image. It should also render a small, yellow, pulsing dot overlay if the `dish.tag` property is present and not `'normal'`. [Source: `docs/prd.md#Section-4`]
    *   `DishGrid`: The main component that will consume the global filter state and the raw `dishes` data. [Source: `docs/architecture.md#Section-6`]
*   **State Management:** The `DishGrid` component must subscribe to the Zustand store created for the `ControlsBar` to get the current filter and sort state. [Source: `docs/prd.md#Story-1.5`]
*   **Layout:** The grid must be responsive, showing 3 columns on tablet/desktop and 2 columns on mobile. [Source: `docs/ui_init.md`]

#### File Locations

*   **Components:**
    *   `apps/client/src/components/features/dishes/DishGrid.tsx`
    *   `apps/client/src/components/features/dishes/DishCard.tsx`
    [Source: `docs/ui_init.md`]

### Tasks / Subtasks

1.  **(AC: 5)** Create the `DishCard.tsx` component file. It should accept a `dish: Dish` prop and render the dish's image. Add logic to display a pulsing yellow dot if the dish has a special tag.
2.  **(AC: 1)** Create the `DishGrid.tsx` component file. It should accept `dishes: Dish[]` as a prop.
3.  **(AC: 1, 2, 3)** Inside `DishGrid`, subscribe to the filter/sort Zustand store.
4.  **(AC: 2, 3)** Implement the filtering and sorting logic within the component. The logic should first filter the `dishes` array based on the `vegOnly` state, and then sort the result based on the `sortBy` state.
5.  **(AC: 4)** Use Tailwind CSS's grid utilities to create the responsive 3-column layout.
6.  **(AC: 5)** Map over the filtered and sorted array of dishes, rendering a `DishCard` for each one.
7.  **(AC: 6)** Add a placeholder `onClick` handler to the `DishCard`.
8.  **Test (Integration):** Write tests for `DishGrid` to verify:
    *   It correctly filters the displayed dishes when the `vegOnly` state changes.
    *   It correctly sorts the displayed dishes when the `sortBy` state changes.
    *   The correct number of cards are rendered.

---

### Tasks / Subtasks (Idempotent)

- [x] **(AC: 5)** Create the `DishCard.tsx` component file.
- [x] **(AC: 1)** Create the `DishGrid.tsx` component file.
- [x] **(AC: 1, 2, 3)** Inside `DishGrid`, subscribe to the `useFilterStore`.
- [x] **(AC: 2, 3)** Implement the filtering and sorting logic.
- [x] **(AC: 4)** Use Tailwind CSS to create the responsive grid layout.
- [x] **(AC: 5)** Render a `DishCard` for each dish.
- [x] **(AC: 6)** Add a placeholder `onClick` handler to the `DishCard`.
- [x] **Test (Integration):** Write and pass all tests for `DishGrid` and `DishCard`.
- [x] **Finalize:** Mark the story as complete.

### Dev Agent Record

**Completion Notes:**

*   **Implementation:** Created two new components:
    1.  `DishCard` (`apps/client/src/components/features/dishes/dish-card.tsx`): A presentational component that displays a single dish image. It includes a visual indicator (a pulsing dot) that is conditionally rendered if the dish has a special tag (e.g., 'bestseller').
    2.  `DishGrid` (`apps/client/src/components/features/dishes/dish-grid.tsx`): A container component that fetches filter and sort state from the `useFilterStore`.
*   **Functionality:** The `DishGrid` component successfully filters and sorts the `dishes` array it receives as a prop based on the global state. The filtering logic handles the "Veg Only" toggle, and the sorting logic handles price sorting in both ascending and descending order.
*   **Layout:** The grid is implemented using Tailwind CSS's responsive grid utilities (`grid-cols-2 md:grid-cols-3`) to ensure it adapts to different screen sizes as required.
*   **Testing:** Developed a comprehensive test suite in `src/__tests__/components/features/dishes/dish-grid.test.tsx` that covers both components. The tests verify the filtering and sorting logic of the grid, as well as the conditional rendering and click handling of the card. All tests are passing.

**File List:**

*   `apps/client/src/components/features/dishes/dish-card.tsx` (created)
*   `apps/client/src/components/features/dishes/dish-grid.tsx` (created)
*   `docs/qa/assessments/1.6-test-dish-grid.md` (created)
*   `apps/client/src/__tests__/components/features/dishes/dish-grid.test.tsx` (created)
*   `docs/stories/1.6.story.md` (modified)

**Change Log:**

*   feat(1.6): create dish grid and dish card components
*   test(1.6): add tests for dish grid and card
