---
epic: 1
story: 4
title: "Category Highlights Bar (v3 - Corrected)"
status: "Draft"
---

### Story Statement

As a user, I want to see the menu categories displayed like Instagram Stories highlights, so I can quickly jump to a category of interest.

### Acceptance Criteria

1.  A `CategoryHighlights` component is created that receives the full list of dishes.
2.  A "Specials" category button is displayed as the first item **if and only if** at least one dish has a `tag` other than `normal`.
3.  The component generates a unique, ordered list of the remaining menu categories.
4.  Each category is rendered as a circular button with a deterministically generated colored gradient ring.
5.  The container is a horizontal, scrollable view with the scrollbar hidden. A portion of the next off-screen button is visible as a UX cue.
6.  Clicking a category button **must trigger the application to enter the full-screen "Reel View"**.
7.  When the Reel View is launched from a category click, it must start on the first dish belonging to that category (respecting any active sort/filter from the Controls Bar). The implementation of the Reel View itself is handled in Epic 2.

### Dev Notes

#### Technical Specifications

*   **Component:** `CategoryHighlights` [Source: `docs/architecture.md#Section-6`]
*   **Data Model:** The component will accept a `dishes: Dish[]` array as a prop and derive the categories from it. [Source: `docs/architecture.md#Section-6`]
*   **UI/UX:** The component should look and feel like Instagram's story highlights bar. It must be a horizontal, scrollable container with the scrollbar hidden. [Source: `docs/prd.md#Section-4`]
*   **Logic:** The component needs to contain logic to extract a unique, sorted list of categories from the `dishes` prop. It also needs to conditionally check for the existence of special tags to render the "Specials" button.

#### File Locations

*   **Component:** `apps/client/src/components/features/categories/category-highlights.tsx` [Source: `docs/ui_init.md`]
*   **Types:** `apps/client/src/lib/types.ts` [Source: `docs/ui-architecture.md#Section-3`]

### Tasks / Subtasks

1.  **(AC: 1)** Create the `category-highlights.tsx` file.
2.  **(AC: 1)** Define the component to accept `dishes: Dish[]` as a prop.
3.  **(AC: 2, 3)** Implement the logic to derive the category list. First, check for any special tags. Then, get all unique category names from the `dishes` array and sort them alphabetically.
4.  **(AC: 4, 5)** Implement the JSX to render the list of categories in a horizontally scrolling flex container. Hide the scrollbar using Tailwind CSS utilities.
5.  **(AC: 4)** For each category button, apply a circular style and a gradient border. The gradient can be generated based on the category name to ensure it's deterministic.
6.  **(AC: 6, 7)** Add a placeholder `onClick` handler to the buttons. The full implementation of launching the Reel View will be handled in a later story.
7.  **Test (Unit):** Write unit tests for the category derivation logic, ensuring it correctly identifies the "Specials" category and produces a unique, sorted list.
8.  **Test (Integration):** Write tests to verify:
    *   The "Specials" button renders only when appropriate.
    *   The correct number of category buttons are rendered.

---

### Tasks / Subtasks (Idempotent)

- [x] **(AC: 1)** Create the `category-highlights.tsx` file.
- [x] **(AC: 1)** Define the component to accept `dishes: Dish[]` and `onCategorySelect` props.
- [x] **(AC: 2, 3)** Implement the logic to derive the category list, including the conditional "Specials" category.
- [x] **(AC: 4, 5)** Implement the JSX to render the categories in a styled, horizontally scrolling container.
- [x] **(AC: 6, 7)** Implement the `onClick` handler to call the `onCategorySelect` prop.
- [x] **Test (Unit & Integration):** Write and pass all tests to verify the component's logic and rendering.
- [x] **Finalize:** Mark the story as complete.

### Dev Agent Record

**Completion Notes:**

*   **Implementation:** Created the `CategoryHighlights` component in `apps/client/src/components/features/categories/category-highlights.tsx`.
*   **Logic:** The component correctly processes the `dishes` array to produce a unique, alphabetically sorted list of categories. It also correctly identifies the presence of special tags (`bestseller`, `new`, etc.) and prepends a "Specials" category to the list when found.
*   **UI/UX:** The component renders the categories as circular buttons within a horizontally scrolling container. The scrollbar is hidden using the `hide-scrollbar` utility class to match the required aesthetic. A deterministic gradient is applied to each button's border based on its name, ensuring a consistent but varied look.
*   **Testing:** Developed a test suite in `src/__tests__/components/features/categories/category-highlights.test.tsx` that validates the category derivation logic, conditional rendering of the "Specials" button, and click handling. All tests are passing.

**File List:**

*   `apps/client/src/components/features/categories/category-highlights.tsx` (created)
*   `docs/qa/assessments/1.4-test-category-highlights.md` (created)
*   `apps/client/src/__tests__/components/features/categories/category-highlights.test.tsx` (created)
*   `docs/stories/1.4.story.md` (modified)

**Change Log:**

*   feat(1.4): create category highlights bar component
*   test(1.4): add tests for category highlights bar
