---
epic: 3
story: 2
title: "Client-Side Search Functionality"
status: "Draft"
---

### Story Statement

As a user, I want to be able to type into a search bar to instantly filter the menu, so I can find a specific dish I'm looking for.

### Acceptance Criteria

1.  As the user types into the search input, the `DishGrid` updates in real-time.
2.  The search is case-insensitive and matches against both the `name` and `description` fields of the dishes.
3.  The search works additively with other filters (e.g., "Veg Only").
4.  A "clear" button is present in the search input to erase the query.
5.  If the search input is cleared, the `DishGrid` reverts to its previous state.

### Dev Notes

#### Technical Specifications

*   **State Management:** The search query string will be added to the `use-filter.store.ts` Zustand store created in Story 1.5.
*   **Component Logic:**
    *   The `ControlsBar` component will be updated to include an `onChange` handler for the search `Input`, which will update the search query in the Zustand store.
    *   The `DishGrid` component's filtering logic will be enhanced to incorporate the search query.
*   **Filtering Logic:** The search filter should be applied *after* any other filters (like "Veg Only"). It should check for the presence of the search string in both `dish.name` and `dish.description`, ignoring case.

#### File Locations

*   This story will modify:
    *   `apps/client/src/components/shared/ControlsBar.tsx`
    *   `apps/client/src/components/features/dishes/DishGrid.tsx`
    *   `apps/client/src/store/use-filter.store.ts`

### Tasks / Subtasks

1.  **State:** Add a `searchQuery: string` property to the `use-filter.store.ts`.
2.  **(AC: 1)** In `ControlsBar.tsx`, add an `onChange` handler to the search `Input` that updates the `searchQuery` in the store.
3.  **(AC: 4)** Add a small 'X' icon button inside the search input that appears when `searchQuery` is not empty. Clicking it should clear the `searchQuery` in the store.
4.  **(AC: 2, 3, 5)** In `DishGrid.tsx`, update the filtering logic. After applying the `vegOnly` filter, apply a second filter based on the `searchQuery`. This filter should return true if the query string is found in the dish's name or description.
5.  **Optimization:** To prevent re-renders on every keystroke, debounce the input from the search field. The state should only be updated after the user has stopped typing for a short period (e.g., 300ms).
6.  **Test (Unit):** Write unit tests for the search filtering logic to ensure it is case-insensitive, checks both fields, and works correctly with an empty query.
7.  **Test (Integration):** Write tests to verify that typing in the `ControlsBar` input correctly updates the `DishGrid` display.
