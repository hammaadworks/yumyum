---
epic: 2
story: 4
title: "Right-Side Action Bar & Drawers (v2)"
status: "Draft"
---

### Story Statement

As a user in the Reel View, I want to access actions like filtering, sharing, and seeing more details about a dish through a clear set of buttons.

### Acceptance Criteria

1.  A `ReelActionBar` component is created and displayed vertically on the **right** side of the Reel View.
2.  The bar contains three buttons in the following top-to-bottom order: **Filter**, **Description**, **Share**.
3.  Clicking the "Filter" button opens a bottom sheet drawer containing the "Sort by Price" and "Veg Only" controls.
4.  Clicking the "Share" button opens the device's native share drawer, pre-populated with a direct link to the current dish.
5.  Clicking the "Description" button opens a bottom sheet drawer displaying all relevant dish data, including its `name`, `description`, `price`, and `tag`.
6.  All drawers can be dismissed by swiping down. The Description drawer can **also** be dismissed by tapping the background area outside the drawer.
7.  The action bar and the drawers must have a "glassmorphic" design.

### Dev Notes

#### Technical Specifications

*   **Components:** This will involve creating a `ReelActionBar` component and at least two drawer components (one for Filters, one for Description). `shadcn-ui`'s `Drawer` component can be used as a foundation.
*   **Icons:** Use icons from `lucide-react` for the action buttons (e.g., `Filter`, `Share`, `Info`).
*   **Styling:** The action bar should be a vertical flex container. The drawers and the bar itself should have a glassmorphic effect. [Source: `docs/prd.md#Story-2.4`]
*   **Interaction:** The opening/closing of drawers will be managed by local component state or a UI Zustand store.

#### File Locations

*   **Action Bar:** `apps/client/src/components/features/reel/ReelActionBar.tsx` (inferred)
*   **Drawers:** `apps/client/src/components/features/reel/drawers/` (new directory, inferred)

### Tasks / Subtasks

1.  **(AC: 1)** Create the `ReelActionBar.tsx` component file.
2.  **(AC: 2)** Add three icon buttons to the action bar in the correct order.
3.  **(AC: 3)** Create a `FilterDrawer` component. When the "Filter" button is clicked, this drawer should be displayed. It should contain the controls from the `ControlsBar` (Story 1.5).
4.  **(AC: 5)** Create a `DescriptionDrawer` component that accepts a `dish: Dish` prop. When the "Description" button is clicked, this drawer should be displayed, showing the details of the current dish.
5.  **(AC: 4)** Implement the "Share" button's `onClick` handler to use the Web Share API (`navigator.share`) to share a link to the current dish.
6.  **(AC: 6)** Ensure the `Drawer` components from `shadcn-ui` are configured to be dismissible via swipe.
7.  **(AC: 7)** Apply glassmorphic styling to all created components.
8.  **Test (Integration):** Write tests to verify:
    *   Clicking each action button opens the correct corresponding drawer or triggers the share API.
    *   The `DescriptionDrawer` displays the correct dish information.

---

### Tasks / Subtasks (Idempotent)

- [x] **(AC: 1)** Create the `ReelActionBar.tsx` component file.
- [x] **(AC: 2)** Add three icon buttons to the action bar.
- [x] **(AC: 3)** Create a `FilterDrawer` component containing the `ControlsBar`.
- [x] **(AC: 5)** Create a `DescriptionDrawer` component to display dish details.
- [x] **(AC: 4)** Implement the "Share" button's `onClick` handler.
- [x] **(AC: 6, 7)** Implement and style the drawers with a glassmorphic effect.
- [x] **Integration:** Integrate the `ReelActionBar` and drawers into the `ReelView`.
- [x] **Test (Integration):** Write and pass all tests to verify the action bar's functionality.
- [x] **Finalize:** Mark the story as complete.

### Dev Agent Record

**Completion Notes:**

*   **Implementation:**
    *   Created the `ReelActionBar` component in `apps/client/src/components/features/reel/reel-action-bar.tsx`.
    *   Created two new drawer components in `apps/client/src/components/features/reel/drawers/`: `FilterDrawer.tsx` and `DescriptionDrawer.tsx`.
*   **Functionality:**
    *   The `ReelActionBar` now renders the Filter, Description, and Share buttons.
    *   The `FilterDrawer` wraps the existing `ControlsBar`.
    *   The `DescriptionDrawer` accepts a `dish` prop and displays its details.
    *   The Share button correctly triggers the `navigator.share` API.
*   **Integration:** The `ReelView` now manages the open/closed state for the drawers and passes the necessary event handlers to the `ReelActionBar`, which is now a more modular, presentational component.
*   **Testing:** Developed a test suite in `src/__tests__/components/features/reel/reel-action-bar.test.tsx` that validates the component's rendering and that the correct callbacks are triggered on button clicks. All tests are passing.

**File List:**

*   `apps/client/src/components/features/reel/drawers/filter-drawer.tsx` (created)
*   `apps/client/src/components/features/reel/drawers/description-drawer.tsx` (created)
*   `apps/client/src/components/features/reel/reel-action-bar.tsx` (created)
*   `apps/client/src/components/features/reel/reel-view.tsx` (modified)
*   `docs/qa/assessments/2.4-test-reel-action-bar.md` (created)
*   `apps/client/src/__tests__/components/features/reel/reel-action-bar.test.tsx` (created)
*   `docs/stories/2.4.story.md` (modified)

**Change Log:**

*   feat(2.4): create reel action bar and drawers
*   test(2.4): add tests for reel action bar
