# Risk Profile: Story 1.2 - Modular & Resilient Data Service

Date: 2025-10-12
Reviewer: Quinn (Test Architect)

## Executive Summary

This story is foundational to the application but carries significant risk due to its external dependencies and the complexity of its caching logic. The primary risks are related to data integrity from the Google Sheet and the potential for vendors to accidentally expose sensitive information.

- **Total Risks Identified:** 7
- **Critical Risks (9):** 0
- **High Risks (6):** 2
- **Medium Risks (4):** 3
- **Low Risks (2-3):** 2
- **Overall Risk Score:** 59/100

## High-Priority Risks

### 1. DATA-001: Data Parsing Errors

*   **Score: 6 (High)**
*   **Probability:** Medium (2) - Non-technical vendors can easily introduce errors (e.g., extra commas, incorrect column order) into the Google Sheet.
*   **Impact:** High (3) - A single parsing error could cause the entire data fetch to fail, rendering the application useless for that vendor.
*   **Mitigation:** Implement robust error handling and data validation during the CSV parsing stage. The service should be able to skip malformed rows and continue processing valid ones. A critical alert should be sent via the Lark webhook when parsing errors are detected.
*   **Testing Focus:** Fuzz testing with malformed CSV data. Test scenarios should include extra columns, missing columns, and invalid data types in cells.

### 2. SEC-001: Accidental Public Data Exposure

*   **Score: 6 (High)**
*   **Probability:** High (3) - Vendors are not technical and may not understand the implications of a "public" sheet. They could easily paste sensitive notes or customer data into the sheet.
*   **Impact:** Medium (2) - While not a system breach, this could lead to reputational damage for the vendor and for YumYum if customer data is exposed.
*   **Mitigation:** This is primarily a business and UX risk. Mitigation involves clear, explicit warnings and education for the vendor during onboarding. The documentation provided to vendors must have a large, red warning box about not putting sensitive information in the sheet.
*   **Testing Focus:** This is not a testable risk in the traditional sense. The focus is on reviewing vendor-facing documentation and the onboarding process.

## Detailed Risk Register

| Risk ID  | Description                        | Category | Probability | Impact | Score | Priority |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| DATA-001 | CSV parsing errors                 | Data     | Medium (2)  | High (3)   | 6     | High     |
| SEC-001  | Accidental public data exposure    | Security | High (3)    | Medium (2) | 6     | High     |
| TECH-001 | Complex caching logic bugs         | Technical| Medium (2)  | Medium (2) | 4     | Medium   |
| PERF-001 | Local Storage performance issues   | Performance| Medium (2)  | Medium (2) | 4     | Medium   |
| OPS-001  | Alerting mechanism failure         | Operational| Medium (2)  | Medium (2) | 4     | Medium   |
| TECH-002 | Google Sheets API dependency       | Technical| Low (1)     | High (3)   | 3     | Low      |
| DATA-002 | Cache invalidation bugs            | Data     | Low (1)     | Medium (2) | 2     | Low      |

## Risk-Based Testing Strategy

### Priority 1: High-Risk Tests (DATA-001)

*   **Test Type:** Integration & Unit Tests
*   **Scenarios:**
    *   Test the data service with CSV files containing missing columns, extra columns, and incorrectly formatted data (e.g., text in a price column).
    *   Verify that the service can gracefully handle these errors, log them, send an alert, and still return any data that was successfully parsed.

### Priority 2: Medium-Risk Tests (TECH-001, PERF-001, OPS-001)

*   **Test Type:** Integration & E2E Tests
*   **Scenarios:**
    *   Verify the SWR caching logic by mocking `localStorage` and `fetch`. Test that data is served from cache first, and that it is re-fetched after the TTL expires.
    *   Test the offline fallback modes. Simulate offline status and verify that the correct fallback UI is displayed based on the state of the cache.
    *   Create a test with a very large (1000+ items) mock dish list to check for any UI blocking or slowdowns during data processing.
    *   Verify that a failed fetch triggers a call to the mocked Lark webhook service.

### Priority 3: Low-Risk Tests (TECH-002, DATA-002)

*   **Test Type:** Manual & Exploratory Testing
*   **Scenarios:**
    *   Manually test the application and confirm that data updates in the Google Sheet are reflected in the app after the cache TTL expires.

## Monitoring Requirements

*   **Alerts:** Configure high-priority alerts for any data fetch failures or CSV parsing errors detected in production.
*   **Dashboards:** A dashboard should be created to monitor the rate of fetch failures per vendor.
